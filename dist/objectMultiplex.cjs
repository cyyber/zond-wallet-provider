"use strict";var w=Object.defineProperty;var y=(t,r,e)=>r in t?w(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var i=(t,r,e)=>y(t,typeof r!="symbol"?r+"":r,e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const l=require("./browser-DjQM3S9H.cjs"),x=require("./_commonjsHelpers-DwGv2jUC.cjs");var p={exports:{}},_=f;function f(t,r){if(t&&r)return f(t)(r);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(o){e[o]=t[o]}),e;function e(){for(var o=new Array(arguments.length),n=0;n<o.length;n++)o[n]=arguments[n];var s=t.apply(this,o),u=o[o.length-1];return typeof s=="function"&&s!==u&&Object.keys(u).forEach(function(a){s[a]=u[a]}),s}}var b=_;p.exports=b(c);p.exports.strict=b(h);c.proto=c(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return c(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return h(this)},configurable:!0})});function c(t){var r=function(){return r.called?r.value:(r.called=!0,r.value=t.apply(this,arguments))};return r.called=!1,r}function h(t){var r=function(){if(r.called)throw new Error(r.onceError);return r.called=!0,r.value=t.apply(this,arguments)},e=t.name||"Function wrapped with `once`";return r.onceError=e+" shouldn't be called more than once",r.called=!1,r}var E=p.exports;const v=x.getDefaultExportFromCjs(E);class m extends l.browserExports.Duplex{constructor({parent:e,name:o,...n}){super({objectMode:!0,...n});i(this,"_parent");i(this,"_name");this._parent=e,this._name=o}_read(){}_write(e,o,n){this._parent.push({name:this._name,data:e}),n()}}const d=Symbol("IGNORE_SUBSTREAM");class j extends l.browserExports.Duplex{constructor(e={}){super({objectMode:!0,...e});i(this,"_substreams");this._substreams={}}createStream(e,o={}){if(this.destroyed)throw new Error(`ObjectMultiplex - parent stream for name "${e}" already destroyed`);if(this._readableState.ended||this._writableState.ended)throw new Error(`ObjectMultiplex - parent stream for name "${e}" already ended`);if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);const n=new m({name:e,parent:this,...o});return this._substreams[e]=n,S(this,s=>n.destroy(s||void 0)),n}ignoreStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=d}_read(){}_write(e,o,n){const{name:s,data:u}=e;if(!s)return console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),n();const a=this._substreams[s];return a?(a!==d&&a.push(u),n()):(console.warn(`ObjectMultiplex - orphaned data for stream "${s}"`),n())}}function S(t,r){const e=v(r);l.browserExports.finished(t,{readable:!1},e),l.browserExports.finished(t,{writable:!1},e)}exports.ObjectMultiplex=j;exports.Substream=m;
