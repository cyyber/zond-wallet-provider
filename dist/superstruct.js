var S=Object.defineProperty;var m=(e,n,r)=>n in e?S(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var d=(e,n,r)=>(m(e,typeof n!="symbol"?n+"":n,r),r);class A extends TypeError{constructor(r,t){let i;const{message:o,explanation:f,...s}=r,{path:a}=r,c=a.length===0?o:`At path: ${a.join(".")} -- ${o}`;super(f??c);d(this,"value");d(this,"key");d(this,"type");d(this,"refinement");d(this,"path");d(this,"branch");d(this,"failures");f!=null&&(this.cause=c),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>i??(i=[r,...t()])}}function z(e){return p(e)&&typeof e[Symbol.iterator]=="function"}function p(e){return typeof e=="object"&&e!==null}function y(e){return typeof e=="symbol"?e.toString():typeof e=="string"?JSON.stringify(e):`${e}`}function N(e){const{done:n,value:r}=e.next();return n?void 0:r}function I(e,n,r,t){if(e===!0)return;e===!1?e={}:typeof e=="string"&&(e={message:e});const{path:i,branch:o}=n,{type:f}=r,{refinement:s,message:a=`Expected a value of type \`${f}\`${s?` with refinement \`${s}\``:""}, but received: \`${y(t)}\``}=e;return{value:t,type:f,refinement:s,key:i[i.length-1],path:i,branch:o,...e,message:a}}function*g(e,n,r,t){z(e)||(e=[e]);for(const i of e){const o=I(i,n,r,t);o&&(yield o)}}function*w(e,n,r={}){const{path:t=[],branch:i=[e],coerce:o=!1,mask:f=!1}=r,s={path:t,branch:i};if(o&&(e=n.coercer(e,s),f&&n.type!=="type"&&p(n.schema)&&p(e)&&!Array.isArray(e)))for(const c in e)n.schema[c]===void 0&&delete e[c];let a="valid";for(const c of n.validator(e,s))c.explanation=r.message,a="not_valid",yield[c,void 0];for(let[c,u,E]of n.entries(e,s)){const x=w(u,E,{path:c===void 0?t:[...t,c],branch:c===void 0?i:[...i,u],coerce:o,mask:f,message:r.message});for(const b of x)b[0]?(a=b[0].refinement===null||b[0].refinement===void 0?"not_valid":"not_refined",yield[b[0],void 0]):o&&(u=b[1],c===void 0?e=u:e instanceof Map?e.set(c,u):e instanceof Set?e.add(u):p(e)&&(u!==void 0||c in e)&&(e[c]=u))}if(a!=="not_valid")for(const c of n.refiner(e,s))c.explanation=r.message,a="not_refined",yield[c,void 0];a==="valid"&&(yield[void 0,e])}class l{constructor(n){d(this,"TYPE");d(this,"type");d(this,"schema");d(this,"coercer");d(this,"validator");d(this,"refiner");d(this,"entries");const{type:r,schema:t,validator:i,refiner:o,coercer:f=a=>a,entries:s=function*(){}}=n;this.type=r,this.schema=t,this.entries=s,this.coercer=f,i?this.validator=(a,c)=>{const u=i(a,c);return g(u,c,this,a)}:this.validator=()=>[],o?this.refiner=(a,c)=>{const u=o(a,c);return g(u,c,this,a)}:this.refiner=()=>[]}assert(n,r){return O(n,this,r)}create(n,r){return V(n,this,r)}is(n){return k(n,this)}mask(n,r){return _(n,this,r)}validate(n,r={}){return $(n,this,r)}}function O(e,n,r){const t=$(e,n,{message:r});if(t[0])throw t[0]}function V(e,n,r){const t=$(e,n,{coerce:!0,message:r});if(t[0])throw t[0];return t[1]}function _(e,n,r){const t=$(e,n,{coerce:!0,mask:!0,message:r});if(t[0])throw t[0];return t[1]}function k(e,n){return!$(e,n)[0]}function $(e,n,r={}){const t=w(e,n,r),i=N(t);return i[0]?[new A(i[0],function*(){for(const s of t)s[0]&&(yield s[0])}),void 0]:[void 0,i[1]]}function h(e,n){return new l({type:e,schema:null,validator:n})}function K(e){let n;return new l({type:"lazy",schema:null,*entries(r,t){n??(n=e()),yield*n.entries(r,t)},validator(r,t){return n??(n=e()),n.validator(r,t)},coercer(r,t){return n??(n=e()),n.coercer(r,t)},refiner(r,t){return n??(n=e()),n.refiner(r,t)}})}function M(){return h("any",()=>!0)}function q(e){return new l({type:"array",schema:e,*entries(n){if(e&&Array.isArray(n))for(const[r,t]of n.entries())yield[r,t,e]},coercer(n){return Array.isArray(n)?n.slice():n},validator(n){return Array.isArray(n)||`Expected an array value, but received: ${y(n)}`}})}function v(){return h("bigint",e=>typeof e=="bigint")}function D(){return h("boolean",e=>typeof e=="boolean")}function J(e){return h("instance",n=>n instanceof e||`Expected a \`${e.name}\` instance, but received: ${y(n)}`)}function P(){return h("integer",e=>typeof e=="number"&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${y(e)}`)}function R(e){const n=y(e),r=typeof e;return new l({type:"literal",schema:r==="string"||r==="number"||r==="boolean"?e:null,validator(t){return t===e||`Expected the literal \`${n}\`, but received: ${y(t)}`}})}function T(){return h("never",()=>!1)}function Y(e){return new l({...e,validator:(n,r)=>n===null||e.validator(n,r),refiner:(n,r)=>n===null||e.refiner(n,r)})}function B(){return h("number",e=>typeof e=="number"&&!isNaN(e)||`Expected a number, but received: ${y(e)}`)}function G(e){const n=e?Object.keys(e):[],r=T();return new l({type:"object",schema:e??null,*entries(t){if(e&&p(t)){const i=new Set(Object.keys(t));for(const o of n)i.delete(o),yield[o,t[o],e[o]];for(const o of i)yield[o,t[o],r]}},validator(t){return p(t)||`Expected an object, but received: ${y(t)}`},coercer(t){return p(t)?{...t}:t}})}function H(e){return new l({...e,validator:(n,r)=>n===void 0||e.validator(n,r),refiner:(n,r)=>n===void 0||e.refiner(n,r)})}function L(e,n){return new l({type:"record",schema:null,*entries(r){if(p(r))for(const t in r){const i=r[t];yield[t,t,e],yield[t,i,n]}},validator(r){return p(r)||`Expected an object, but received: ${y(r)}`}})}function Q(){return h("string",e=>typeof e=="string"||`Expected a string, but received: ${y(e)}`)}function U(e){const n=e.map(r=>r.type).join(" | ");return new l({type:"union",schema:null,coercer(r){for(const t of e){const[i,o]=t.validate(r,{coerce:!0});if(!i)return o}return r},validator(r,t){const i=[];for(const o of e){const[...f]=w(r,o,t),[s]=f;if(!(s!=null&&s[0]))return[];for(const[a]of f)a&&i.push(a)}return[`Expected the value to satisfy a union of \`${n}\`, but received: ${y(r)}`,...i]}})}function W(){return h("unknown",()=>!0)}function X(e,n,r){return new l({...e,coercer:(t,i)=>k(t,n)?e.coercer(r(t,i),i):e.coercer(t,i)})}function Z(e,n){return j(e,"pattern",r=>n.test(r)||`Expected a ${e.type} matching \`/${n.source}/\` but received "${r}"`)}function C(e,n,r=n){const t=`Expected a ${e.type}`,i=n===r?`of \`${n}\``:`between \`${n}\` and \`${r}\``;return j(e,"size",o=>{if(typeof o=="number"||o instanceof Date)return n<=o&&o<=r||`${t} ${i} but received \`${o}\``;if(o instanceof Map||o instanceof Set){const{size:s}=o;return n<=s&&s<=r||`${t} with a size ${i} but received one with a size of \`${s}\``}const{length:f}=o;return n<=f&&f<=r||`${t} with a length ${i} but received one with a length of \`${f}\``})}function j(e,n,r){return new l({...e,*refiner(t,i){yield*e.refiner(t,i);const o=r(t,i),f=g(o,i,e,t);for(const s of f)yield{...s,refinement:n}}})}export{l as S,O as a,C as b,X as c,J as d,v as e,Y as f,P as g,H as h,k as i,D as j,q as k,R as l,M as m,B as n,G as o,Z as p,W as q,L as r,Q as s,h as t,U as u,K as v,j as w};
