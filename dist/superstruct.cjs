"use strict";var q=Object.defineProperty;var F=(e,t,n)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var p=(e,t,n)=>(F(e,typeof t!="symbol"?t+"":t,n),n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});class O extends TypeError{constructor(n,r){let i;const{message:o,explanation:f,...c}=n,{path:a}=n,s=a.length===0?o:`At path: ${a.join(".")} -- ${o}`;super(f??s);p(this,"value");p(this,"key");p(this,"type");p(this,"refinement");p(this,"path");p(this,"branch");p(this,"failures");f!=null&&(this.cause=s),Object.assign(this,c),this.name=this.constructor.name,this.failures=()=>i??(i=[n,...r()])}}function K(e){return b(e)&&typeof e[Symbol.iterator]=="function"}function b(e){return typeof e=="object"&&e!==null}function z(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function d(e){return typeof e=="symbol"?e.toString():typeof e=="string"?JSON.stringify(e):`${e}`}function R(e){const{done:t,value:n}=e.next();return t?void 0:n}function J(e,t,n,r){if(e===!0)return;e===!1?e={}:typeof e=="string"&&(e={message:e});const{path:i,branch:o}=t,{type:f}=n,{refinement:c,message:a=`Expected a value of type \`${f}\`${c?` with refinement \`${c}\``:""}, but received: \`${d(r)}\``}=e;return{value:r,type:f,refinement:c,key:i[i.length-1],path:i,branch:o,...e,message:a}}function*j(e,t,n,r){K(e)||(e=[e]);for(const i of e){const o=J(i,t,n,r);o&&(yield o)}}function*k(e,t,n={}){const{path:r=[],branch:i=[e],coerce:o=!1,mask:f=!1}=n,c={path:r,branch:i};if(o&&(e=t.coercer(e,c),f&&t.type!=="type"&&b(t.schema)&&b(e)&&!Array.isArray(e)))for(const s in e)t.schema[s]===void 0&&delete e[s];let a="valid";for(const s of t.validator(e,c))s.explanation=n.message,a="not_valid",yield[s,void 0];for(let[s,l,P]of t.entries(e,c)){const D=k(l,P,{path:s===void 0?r:[...r,s],branch:s===void 0?i:[...i,l],coerce:o,mask:f,message:n.message});for(const $ of D)$[0]?(a=$[0].refinement===null||$[0].refinement===void 0?"not_valid":"not_refined",yield[$[0],void 0]):o&&(l=$[1],s===void 0?e=l:e instanceof Map?e.set(s,l):e instanceof Set?e.add(l):b(e)&&(l!==void 0||s in e)&&(e[s]=l))}if(a!=="not_valid")for(const s of t.refiner(e,c))s.explanation=n.message,a="not_refined",yield[s,void 0];a==="valid"&&(yield[void 0,e])}class u{constructor(t){p(this,"TYPE");p(this,"type");p(this,"schema");p(this,"coercer");p(this,"validator");p(this,"refiner");p(this,"entries");const{type:n,schema:r,validator:i,refiner:o,coercer:f=a=>a,entries:c=function*(){}}=t;this.type=n,this.schema=r,this.entries=c,this.coercer=f,i?this.validator=(a,s)=>{const l=i(a,s);return j(l,s,this,a)}:this.validator=()=>[],o?this.refiner=(a,s)=>{const l=o(a,s);return j(l,s,this,a)}:this.refiner=()=>[]}assert(t,n){return A(t,this,n)}create(t,n){return M(t,this,n)}is(t){return x(t,this)}mask(t,n){return N(t,this,n)}validate(t,n={}){return m(t,this,n)}}function A(e,t,n){const r=m(e,t,{message:n});if(r[0])throw r[0]}function M(e,t,n){const r=m(e,t,{coerce:!0,message:n});if(r[0])throw r[0];return r[1]}function N(e,t,n){const r=m(e,t,{coerce:!0,mask:!0,message:n});if(r[0])throw r[0];return r[1]}function x(e,t){return!m(e,t)[0]}function m(e,t,n={}){const r=k(e,t,n),i=R(r);return i[0]?[new O(i[0],function*(){for(const c of r)c[0]&&(yield c[0])}),void 0]:[void 0,i[1]]}function Y(...e){var i;const t=((i=e[0])==null?void 0:i.type)==="type",n=e.map(({schema:o})=>o),r=Object.assign({},...n);return t?w(r):g(r)}function y(e,t){return new u({type:e,schema:null,validator:t})}function B(e,t){return new u({...e,refiner:(n,r)=>n===void 0||e.refiner(n,r),validator(n,r){return n===void 0?!0:(t(n,r),e.validator(n,r))}})}function G(e){return new u({type:"dynamic",schema:null,*entries(t,n){yield*e(t,n).entries(t,n)},validator(t,n){return e(t,n).validator(t,n)},coercer(t,n){return e(t,n).coercer(t,n)},refiner(t,n){return e(t,n).refiner(t,n)}})}function H(e){let t;return new u({type:"lazy",schema:null,*entries(n,r){t??(t=e()),yield*t.entries(n,r)},validator(n,r){return t??(t=e()),t.validator(n,r)},coercer(n,r){return t??(t=e()),t.coercer(n,r)},refiner(n,r){return t??(t=e()),t.refiner(n,r)}})}function L(e,t){const{schema:n}=e,r={...n};for(const i of t)delete r[i];switch(e.type){case"type":return w(r);default:return g(r)}}function Q(e){const t=e instanceof u,n=t?{...e.schema}:{...e};for(const r in n)n[r]=T(n[r]);return t&&e.type==="type"?w(n):g(n)}function U(e,t){const{schema:n}=e,r={};for(const i of t)r[i]=n[i];switch(e.type){case"type":return w(r);default:return g(r)}}function W(){return y("any",()=>!0)}function X(e){return new u({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[n,r]of t.entries())yield[n,r,e]},coercer(t){return Array.isArray(t)?t.slice():t},validator(t){return Array.isArray(t)||`Expected an array value, but received: ${d(t)}`}})}function Z(){return y("bigint",e=>typeof e=="bigint")}function C(){return y("boolean",e=>typeof e=="boolean")}function v(){return y("date",e=>e instanceof Date&&!isNaN(e.getTime())||`Expected a valid \`Date\` object, but received: ${d(e)}`)}function ee(e){const t={},n=e.map(r=>d(r)).join();for(const r of e)t[r]=r;return new u({type:"enums",schema:t,validator(r){return e.includes(r)||`Expected one of \`${n}\`, but received: ${d(r)}`}})}function te(){return y("func",e=>typeof e=="function"||`Expected a function, but received: ${d(e)}`)}function ne(e){return y("instance",t=>t instanceof e||`Expected a \`${e.name}\` instance, but received: ${d(t)}`)}function re(){return y("integer",e=>typeof e=="number"&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${d(e)}`)}function ie(e){return new u({type:"intersection",schema:null,*entries(t,n){for(const{entries:r}of e)yield*r(t,n)},*validator(t,n){for(const{validator:r}of e)yield*r(t,n)},*refiner(t,n){for(const{refiner:r}of e)yield*r(t,n)}})}function oe(e){const t=d(e),n=typeof e;return new u({type:"literal",schema:n==="string"||n==="number"||n==="boolean"?e:null,validator(r){return r===e||`Expected the literal \`${t}\`, but received: ${d(r)}`}})}function ce(e,t){return new u({type:"map",schema:null,*entries(n){if(e&&t&&n instanceof Map)for(const[r,i]of n.entries())yield[r,r,e],yield[r,i,t]},coercer(n){return n instanceof Map?new Map(n):n},validator(n){return n instanceof Map||`Expected a \`Map\` object, but received: ${d(n)}`}})}function E(){return y("never",()=>!1)}function se(e){return new u({...e,validator:(t,n)=>t===null||e.validator(t,n),refiner:(t,n)=>t===null||e.refiner(t,n)})}function fe(){return y("number",e=>typeof e=="number"&&!isNaN(e)||`Expected a number, but received: ${d(e)}`)}function g(e){const t=e?Object.keys(e):[],n=E();return new u({type:"object",schema:e??null,*entries(r){if(e&&b(r)){const i=new Set(Object.keys(r));for(const o of t)i.delete(o),yield[o,r[o],e[o]];for(const o of i)yield[o,r[o],n]}},validator(r){return b(r)||`Expected an object, but received: ${d(r)}`},coercer(r){return b(r)?{...r}:r}})}function T(e){return new u({...e,validator:(t,n)=>t===void 0||e.validator(t,n),refiner:(t,n)=>t===void 0||e.refiner(t,n)})}function ae(e,t){return new u({type:"record",schema:null,*entries(n){if(b(n))for(const r in n){const i=n[r];yield[r,r,e],yield[r,i,t]}},validator(n){return b(n)||`Expected an object, but received: ${d(n)}`}})}function ue(){return y("regexp",e=>e instanceof RegExp)}function de(e){return new u({type:"set",schema:null,*entries(t){if(e&&t instanceof Set)for(const n of t)yield[n,n,e]},coercer(t){return t instanceof Set?new Set(t):t},validator(t){return t instanceof Set||`Expected a \`Set\` object, but received: ${d(t)}`}})}function V(){return y("string",e=>typeof e=="string"||`Expected a string, but received: ${d(e)}`)}function pe(e){const t=E();return new u({type:"tuple",schema:null,*entries(n){if(Array.isArray(n)){const r=Math.max(e.length,n.length);for(let i=0;i<r;i++)yield[i,n[i],e[i]||t]}},validator(n){return Array.isArray(n)||`Expected an array, but received: ${d(n)}`}})}function w(e){const t=Object.keys(e);return new u({type:"type",schema:e,*entries(n){if(b(n))for(const r of t)yield[r,n[r],e[r]]},validator(n){return b(n)||`Expected an object, but received: ${d(n)}`},coercer(n){return b(n)?{...n}:n}})}function ye(e){const t=e.map(n=>n.type).join(" | ");return new u({type:"union",schema:null,coercer(n){for(const r of e){const[i,o]=r.validate(n,{coerce:!0});if(!i)return o}return n},validator(n,r){const i=[];for(const o of e){const[...f]=k(n,o,r),[c]=f;if(!(c!=null&&c[0]))return[];for(const[a]of f)a&&i.push(a)}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${d(n)}`,...i]}})}function I(){return y("unknown",()=>!0)}function S(e,t,n){return new u({...e,coercer:(r,i)=>x(r,t)?e.coercer(n(r,i),i):e.coercer(r,i)})}function le(e,t,n={}){return S(e,I(),r=>{const i=typeof t=="function"?t():t;if(r===void 0)return i;if(!n.strict&&z(r)&&z(i)){const o={...r};let f=!1;for(const c in i)o[c]===void 0&&(o[c]=i[c],f=!0);if(f)return o}return r})}function be(e){return S(e,V(),t=>t.trim())}function he(e){return h(e,"empty",t=>{const n=_(t);return n===0||`Expected an empty ${e.type} but received one with a size of \`${n}\``})}function _(e){return e instanceof Map||e instanceof Set?e.size:e.length}function me(e,t,n={}){const{exclusive:r}=n;return h(e,"max",i=>r?i<t:i<=t||`Expected a ${e.type} less than ${r?"":"or equal to "}${t} but received \`${i}\``)}function $e(e,t,n={}){const{exclusive:r}=n;return h(e,"min",i=>r?i>t:i>=t||`Expected a ${e.type} greater than ${r?"":"or equal to "}${t} but received \`${i}\``)}function ge(e){return h(e,"nonempty",t=>_(t)>0||`Expected a nonempty ${e.type} but received an empty one`)}function we(e,t){return h(e,"pattern",n=>t.test(n)||`Expected a ${e.type} matching \`/${t.source}/\` but received "${n}"`)}function je(e,t,n=t){const r=`Expected a ${e.type}`,i=t===n?`of \`${t}\``:`between \`${t}\` and \`${n}\``;return h(e,"size",o=>{if(typeof o=="number"||o instanceof Date)return t<=o&&o<=n||`${r} ${i} but received \`${o}\``;if(o instanceof Map||o instanceof Set){const{size:c}=o;return t<=c&&c<=n||`${r} with a size ${i} but received one with a size of \`${c}\``}const{length:f}=o;return t<=f&&f<=n||`${r} with a length ${i} but received one with a length of \`${f}\``})}function h(e,t,n){return new u({...e,*refiner(r,i){yield*e.refiner(r,i);const o=n(r,i),f=j(o,i,e,r);for(const c of f)yield{...c,refinement:t}}})}exports.Struct=u;exports.StructError=O;exports.any=W;exports.array=X;exports.assert=A;exports.assign=Y;exports.bigint=Z;exports.boolean=C;exports.coerce=S;exports.create=M;exports.date=v;exports.defaulted=le;exports.define=y;exports.deprecated=B;exports.dynamic=G;exports.empty=he;exports.enums=ee;exports.func=te;exports.instance=ne;exports.integer=re;exports.intersection=ie;exports.is=x;exports.lazy=H;exports.literal=oe;exports.map=ce;exports.mask=N;exports.max=me;exports.min=$e;exports.never=E;exports.nonempty=ge;exports.nullable=se;exports.number=fe;exports.object=g;exports.omit=L;exports.optional=T;exports.partial=Q;exports.pattern=we;exports.pick=U;exports.record=ae;exports.refine=h;exports.regexp=ue;exports.set=de;exports.size=je;exports.string=V;exports.trimmed=be;exports.tuple=pe;exports.type=w;exports.union=ye;exports.unknown=I;exports.validate=m;
